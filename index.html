<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>| پارسیان |</title>
  <style>
    @font-face {
      font-family: 'tabriz';
      src: url('./tabriz.ttf') format('truetype');
    }

    :root {
      --text-light: #222;
      --text-dark: #fff;
      --scroll-thumb-light: linear-gradient(180deg, rgba(0,123,255,0.95), rgba(0,224,255,0.95));
      --scroll-thumb-dark: linear-gradient(180deg, rgba(0,150,255,0.95), rgba(0,200,255,0.95));
      --scroll-track: transparent;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'tabriz', Tahoma, sans-serif;
      overflow-x: hidden;
      transition: background 0.6s, color 0.6s;
    }

    body.light {
      background: linear-gradient(-45deg, #ffe4e1, #bae8da, #d2f8ff, #ffd1ff);
      background-size: 400% 400%;
      color: var(--text-light);
      animation: gradient 15s ease infinite;
    }

    body.dark {
      background: radial-gradient(circle, #0f2027, #203a43, #2c5364);
      color: var(--text-dark);
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* اسکرول‌بار */
    ::-webkit-scrollbar { width: 8px; height: 8px; }

    ::-webkit-scrollbar-track { 
      background: transparent; 
    }

    ::-webkit-scrollbar-thumb {
      border-radius: 999px;
      border: 3px solid rgba(255,255,255,0.06);
      box-shadow: inset 0 0 6px rgba(0,0,0,0.2);
      background: linear-gradient(180deg, rgba(0,123,255,0.95), rgba(0,224,255,0.95));
      background-size: 200% 200%;
      transition: transform 120ms ease, box-shadow 120ms ease;
      animation: scrollGradient 5s linear infinite;
    }

    body.dark ::-webkit-scrollbar-track {
      background: rgba(20,20,30,0.6);
    }

    body.dark ::-webkit-scrollbar-thumb {
      border: 3px solid rgba(0,0,0,0.25);
      box-shadow: inset 0 0 6px rgba(0,0,0,0.5);
      background: linear-gradient(180deg, rgba(0,150,255,0.95), rgba(0,200,255,0.95));
      background-size: 200% 200%;
      animation: scrollGradient 5s linear infinite;
    }

    ::-webkit-scrollbar-thumb:hover {
      transform: scaleY(1.06);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.28);
    }

    @keyframes scrollGradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    header {
      text-align: center;
      padding: 2rem 1rem;
      position: relative;
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    body.dark header {
      background: rgba(0, 0, 0, 0.2);
    }

    #logo {
      width: 60px;
      height: 60px;
      border-radius: 15px;
      background: linear-gradient(135deg, #00bcd4, #0066cc);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      box-shadow: 0 4px 15px rgba(0, 188, 212, 0.3);
    }

    #logo svg {
      width: 35px;
      height: 35px;
      fill: white;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .theme-toggle, .auth-toggle, .menu-toggle {
      position: absolute;
      top: 20px;
      background: rgba(255, 255, 255, 0.8);
      border: none;
      border-radius: 8px;
      padding: 0.5rem 0.8rem;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    body.dark .theme-toggle,
    body.dark .auth-toggle,
    body.dark .menu-toggle {
      background: rgba(0, 0, 0, 0.5);
      color: white;
    }

    .theme-toggle { left: 20px; }
    .auth-toggle { left: 75px; }
    .menu-toggle { 
      right: 20px;
      display: none;
    }

    .theme-toggle:hover, 
    .auth-toggle:hover,
    .menu-toggle:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .menu {
      position: fixed;
      top: 0;
      right: -280px;
      width: 260px;
      height: 100%;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: -4px 0 15px rgba(0,0,0,0.2);
      transition: right 0.3s ease;
      padding-top: 5rem;
      z-index: 1000;
      display: none;
    }

    body.dark .menu { 
      background: rgba(20, 20, 30, 0.95); 
    }

    .menu.open { right: 0; }

    .menu a {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 1.2rem 1.5rem;
      color: inherit;
      text-decoration: none;
      font-weight: 500;
      border-bottom: 1px solid rgba(0,0,0,0.05);
      transition: background 0.3s;
    }

    body.dark .menu a {
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .menu a:hover { 
      background: rgba(0, 188, 212, 0.1); 
    }

    main {
      padding: 3rem 1.5rem;
      max-width: 1200px;
      margin: auto;
      min-height: 60vh;
    }

    .welcome-section {
      text-align: center;
      padding: 2rem 0;
    }

    .welcome-section h2 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    .welcome-section p {
      font-size: 1.2rem;
      opacity: 0.8;
      margin-bottom: 2rem;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin-top: 3rem;
    }

    .card {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.dark .card {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .card-icon {
      width: 70px;
      height: 70px;
      border-radius: 12px;
      margin: 0 auto 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .card-icon svg {
      width: 35px;
      height: 35px;
      fill: white;
    }

    .card-icon.cart {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .card-icon.panel {
      background: linear-gradient(135deg, #00bcd4, #0066cc);
    }

    .card-icon.download {
      background: linear-gradient(135deg, #a855f7, #ec4899);
    }

    .card h3 {
      font-size: 1.4rem;
      margin-bottom: 0.8rem;
    }

    .card p {
      opacity: 0.8;
      font-size: 0.95rem;
    }

    .chat-box {
      position: fixed;
      bottom: 25px;
      right: 25px;
      display: flex;
      align-items: center;
      padding: 12px 18px;
      border-radius: 50px;
      background: linear-gradient(90deg, rgba(0,123,255,0.95), rgba(0,224,255,0.95));
      background-size: 200% 100%;
      animation: moveBg 5s linear infinite;
      z-index: 3000;
      box-shadow: 0 10px 30px rgba(0, 188, 212, 0.4);
    }

    @keyframes moveBg {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }

    .chat-box input {
      border: none;
      outline: none;
      background: #fff;
      color: #111;
      font-size: 1rem;
      font-family: inherit;
      border-radius: 25px;
      padding: 8px 16px;
      margin-left: 12px;
      min-width: 220px;
    }

    body.dark .chat-box input { 
      background: #1a1a1a; 
      color: #fff; 
    }

    .chat-box button {
      border: none;
      background: #111;
      font-size: 1.3rem;
      cursor: pointer;
      color: #fff;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }

    .chat-box button:hover {
      transform: scale(1.1);
    }

    body.dark .chat-box button { 
      background: #f0f0f0; 
      color: #111; 
    }

    footer {
      text-align: center;
      padding: 1.5rem;
      font-size: 0.9rem;
      opacity: 0.8;
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.1);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      margin-top: 3rem;
    }

    body.dark footer {
      background: rgba(0, 0, 0, 0.2);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 2.5rem;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
    }

    body.dark .modal-content {
      background: #1a1a1a;
      color: white;
    }

    .modal-content h2 {
      margin-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    .modal-content p {
      opacity: 0.7;
      margin-bottom: 1.5rem;
    }

    .modal-content input {
      width: 100%;
      padding: 12px;
      margin-bottom: 1rem;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
    }

    body.dark .modal-content input {
      background: #2a2a2a;
      border-color: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .modal-content button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #00bcd4, #0066cc);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .modal-content button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 188, 212, 0.4);
    }

    .hidden { display: none; }

    @media (max-width: 768px) {
      .menu-toggle { display: inline-block; }
      .cards-grid { grid-template-columns: 1fr; }
      .chat-box input { min-width: 150px; }
    }
  </style>
</head>
<body class="light">

<header>
  <div id="logo">
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
    </svg>
  </div>
  <h1>کیت هوشمند سازی پارسیان</h1>
  <p class="subtitle">مدیریت هوشمند وسایل خانه</p>
  
  <button class="theme-toggle" id="themeBtn">🌙</button>
  <button class="auth-toggle" onclick="showLogin()">🔐</button>
  <button class="menu-toggle" id="menuToggle" onclick="toggleMenu()">☰</button>
</header>

<div class="menu" id="menu">
  <a href="javascript:void(0)" onclick="handleCart()">
    🛒 سبد خرید
  </a>
  <a href="http://192.168.4.1" target="_blank">
    🏠 کنترل پنل
  </a>
  <a href="javascript:void(0)" id="log-list" class="hidden" onclick="showUsers()">
    👥 مشاهده کاربران
  </a>
  <a href="https://i.diawi.com/jYurYF" target="_blank">
    ⬇ دانلود نرم‌افزار
  </a>
</div>

<main>
  <div id="content"></div>
</main>

<footer>Created by PJA Group | 2025</footer>

<div class="chat-box">
  <input type="text" id="chatInput" placeholder="هر چیزی بپرس..." />
  <button onclick="sendMail()">➤</button>
</div>

<!-- Login Modal -->
<div class="modal" id="loginModal">
  <div class="modal-content">
    <h2>ورود به پارسیان</h2>
    <p>اطلاعات خود را وارد کنید</p>
    <form id="loginForm">
      <input type="text" id="userName" placeholder="نام خود را وارد کنید" required />
      <input type="email" id="userEmail" placeholder="ایمیل خود را وارد کنید" required />
      <button type="submit">ورود / ثبت‌نام</button>
    </form>
  </div>
</div>

<script>
  const body = document.body;
  const themeBtn = document.getElementById("themeBtn");
  const menu = document.getElementById("menu");
  const content = document.getElementById("content");
  const logList = document.getElementById("log-list");
  const menuToggle = document.getElementById("menuToggle");
  const loginModal = document.getElementById("loginModal");
  const loginForm = document.getElementById("loginForm");
  const chatInput = document.getElementById("chatInput");

  let userLogged = false;
  let currentUser = null;

  // Theme Toggle
  themeBtn.onclick = () => {
    body.classList.toggle("dark");
    body.classList.toggle("light");
    themeBtn.textContent = body.classList.contains("dark") ? "☀️" : "🌙";
    localStorage.setItem("theme", body.classList.contains("dark") ? "dark" : "light");
  };

  // Load saved theme
  const savedTheme = localStorage.getItem("theme");
  if (savedTheme === "dark") {
    body.classList.remove("light");
    body.classList.add("dark");
    themeBtn.textContent = "☀️";
  }

  // Toggle Menu
  function toggleMenu() {
    if (!userLogged) { 
      alert("ابتدا وارد یا ثبت‌نام کنید"); 
      return; 
    }
    menu.classList.toggle("open");
  }

  // Show Login
  function showLogin() {
    loginModal.classList.add("active");
  }

  // Close modal on outside click
  loginModal.onclick = (e) => {
    if (e.target === loginModal) {
      loginModal.classList.remove("active");
    }
  };

  // Handle Login
  loginForm.onsubmit = (e) => {
    e.preventDefault();
    const name = document.getElementById("userName").value;
    const email = document.getElementById("userEmail").value;

    if (name && email) {
      const time = new Date().toLocaleString("fa-IR");
      const newUser = { name, email, time };
      
      let users = JSON.parse(localStorage.getItem("users") || "[]");
      users.push(newUser);
      localStorage.setItem("users", JSON.stringify(users));
      localStorage.setItem("user", JSON.stringify(newUser));
      
      userLogged = true;
      currentUser = newUser;
      loginModal.classList.remove("active");

      menu.style.display = "block";
      menuToggle.style.display = "inline-block";

      if (name.toLowerCase() === "parsa" && email.toLowerCase() === "parsasoorme138700@gmail.com") {
        logList.classList.remove("hidden");
      }

      showDashboard();
    }
  };

  // Show Dashboard
  function showDashboard() {
    content.innerHTML = `
      <div class="welcome-section">
        <h2>سلام ${currentUser.name} عزیز!</h2>
        <p>به پنل مدیریت هوشمند پارسیان خوش آمدید</p>
        
        <div class="cards-grid">
          <div class="card" onclick="handleCart()">
            <div class="card-icon cart">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
              </svg>
            </div>
            <h3>سبد خرید</h3>
            <p>خرید محصولات هوشمند</p>
          </div>

          <div class="card" onclick="window.open('http://192.168.4.1', '_blank')">
            <div class="card-icon panel">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
              </svg>
            </div>
            <h3>کنترل پنل</h3>
            <p>دسترسی به پنل ESP32</p>
          </div>

          <div class="card" onclick="window.open('https://i.diawi.com/jYurYF', '_blank')">
            <div class="card-icon download">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/>
              </svg>
            </div>
            <h3>دانلود اپلیکیشن</h3>
            <p>نرم‌افزار موبایل</p>
          </div>
        </div>
      </div>
    `;
  }

  // Show Users (Admin only)
  function showUsers() {
    if (!(currentUser && currentUser.name.toLowerCase() === "parsa" && currentUser.email.toLowerCase() === "parsasoorme138700@gmail.com")) return;
    
    const users = JSON.parse(localStorage.getItem("users") || "[]");
    
    let html = '<div class="welcome-section"><h2>لیست کاربران</h2>';
    html += `<p>تعداد کل کاربران: ${users.length}</p><div style="margin-top: 2rem;">`;
    
    if (users.length === 0) {
      html += '<p>هیچ کاربری هنوز ثبت‌نام نکرده است.</p>';
    } else {
      users.forEach(u => {
        html += `
          <div style="background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); padding: 1rem; border-radius: 10px; margin-bottom: 1rem; text-align: right;">
            <strong>${u.name}</strong> - ${u.email}<br>
            <small style="opacity: 0.7">${u.time}</small>
          </div>
        `;
      });
    }
    
    html += '</div></div>';
    content.innerHTML = html;
    menu.classList.remove("open");
  }

  // Handle Cart
  function handleCart() {
    alert("❌ فعلاً سرویس در دسترس نمی‌باشد");
  }

  // Send Mail
  function sendMail() {
    const message = chatInput.value.trim();
    if (message) {
      window.open(`mailto:ticketsuupporting@gmail.com?subject=پیام از سایت&body=${encodeURIComponent(message)}`, "_blank");
      chatInput.value = "";
    }
  }

  // Enter key for chat
  chatInput.addEventListener("keypress", (e) => {
    if (e.key === "Enter") {
      sendMail();
    }
  });

  // Load saved user
  window.onload = () => {
    const saved = localStorage.getItem("user");
    if (saved) {
      const user = JSON.parse(saved);
      userLogged = true;
      currentUser = user;
      menu.style.display = "block";
      menuToggle.style.display = "inline-block";
      
      if (user.name.toLowerCase() === "parsa" && user.email.toLowerCase() === "parsasoorme138700@gmail.com") {
        logList.classList.remove("hidden");
      }
      
      showDashboard();
    } else {
      content.innerHTML = `
        <div class="welcome-section">
          <h2>به پارسیان خوش آمدید</h2>
          <p>خانه هوشمند خود را با جدیدترین تکنولوژی مدیریت کنید</p>
        </div>
      `;
    }
  };
</script>

</body>
</html>
